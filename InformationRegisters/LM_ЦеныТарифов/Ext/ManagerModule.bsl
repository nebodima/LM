Функция ПолучитьСуммуТарифаНаДату(Тариф, Дата) Экспорт
	
	С = новый Структура;
	
	Запрос = Новый Запрос;
	Запрос.Текст = 
		"ВЫБРАТЬ
		|	ЦеныТарифовСрезПоследних.Сумма КАК Сумма,
		|	ЦеныТарифовСрезПоследних.КоличествоЧасов КАК КоличествоЧасов,
		|	ЦеныТарифовСрезПоследних.КоличествоУроков КАК КоличествоУроков,
		|	ЦеныТарифовСрезПоследних.Период КАК Период
		|ИЗ
		|	РегистрСведений.LM_ЦеныТарифов.СрезПоследних(&Период, Тариф = &Тариф) КАК ЦеныТарифовСрезПоследних";  	
	Запрос.УстановитьПараметр("Период", Дата);
	Запрос.УстановитьПараметр("Тариф", Тариф);
	РезультатЗапроса = Запрос.Выполнить().Выгрузить();
	
	Если РезультатЗапроса.Количество() = 1 Тогда
		
		Если РезультатЗапроса[0].КоличествоУроков = 0 и РезультатЗапроса[0].КоличествоЧасов = 0 Тогда
			С.Вставить("КоличествоУроков",1);
		Иначе
			С.Вставить("КоличествоУроков",РезультатЗапроса[0].КоличествоУроков);
		КонецЕсли;
		
		С.Вставить("КоличествоЧасов",РезультатЗапроса[0].КоличествоЧасов);
		С.Вставить("Сумма",РезультатЗапроса[0].Сумма);
		
		Возврат С;
		
	КонецЕсли;

	Возврат Неопределено;
	
КонецФункции
